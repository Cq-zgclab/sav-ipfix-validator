# SAV IPFIX 实时流式演示系统 - 演示脚本

## 演示目标
在 **5 分钟** 内展示 SAV IPFIX 扩展字段的实时流式输出特性和三个进阶分析场景。

---

## 🎬 演示流程（总计 5 分钟）

### 第一部分：开场介绍（30 秒）

**讲解要点**：
```
大家好，今天演示的是基于 IPFIX 协议的 SAV（源地址验证）实时遥测系统。

IPFIX 是 IETF 标准的网络流遥测协议（RFC 7011），我们基于 
draft-cao-opsawg-ipfix-sav-01 草案，扩展了 4 个 SAV 专用信息元素。

这个系统将展示：
1. IPFIX 的实时流式推送特性
2. SAV 扩展字段的实际应用
3. 从宏观到微观的多维度分析
```

**操作**：
- 打开浏览器，访问 `http://localhost:8888`
- 指出界面的三个主要区域：
  - 控制面板（顶部）
  - 实时事件流（中间）
  - 进阶分析面板（底部）

---

### 第二部分：实时流式展示（1分30秒）

**讲解要点**：
```
现在启动 IPFIX 数据流。这模拟了真实网络中 SAV 路由器通过 IPFIX 
协议实时推送验证记录的过程。

我们预先生成了 27 条 IPFIX 记录，涵盖三个典型场景：
1. 攻击检测 - 13 条记录
2. 接口分布分析 - 7 条记录  
3. 策略动作效果 - 7 条记录
```

**操作**（边讲边操作）：
1. **点击 Start 按钮**
   ```
   看到了吗？记录开始实时推送。每条记录都包含完整的 SAV 扩展字段。
   ```

2. **指出时间轴（左侧）**
   ```
   左侧时间轴显示记录到达的时序，高亮的是当前记录。
   ```

3. **展开第一条记录，逐一讲解字段**：
   ```
   重点看这 4 个 SAV 扩展字段：
   
   - savRuleType = 0 (Allowlist)
     表示使用允许列表验证模式
   
   - savTargetType = 0 (Interface-Based)  
     表示基于接口的验证
   
   - savPolicyAction = 1 (Discard)
     验证失败后的处理动作是丢弃
   
   - savMatchedContentList
     这是一个 SubTemplateList（RFC 6313），包含具体的
     接口-前缀映射规则
   ```

4. **演示播放控制**：
   - 点击 **Pause** 暂停
     ```
     可以随时暂停，便于详细讲解某条记录
     ```
   
   - 调整速度到 **2x**
     ```
     支持 4 档速度：0.5x、1x、2x、4x
     可以根据演示需要加速或放慢
     ```
   
   - 点击 **Resume** 继续

---

### 第三部分：进阶场景分析（2分钟）

#### 场景1：根本原因分析（40秒）

**讲解要点**：
```
切换到"根本原因分析"面板。这个场景展示了当 SAV 验证失败时，
如何快速定位根本原因。
```

**操作**：
1. 点击 **Root Cause Analysis** 标签
2. 指出统计卡片：
   ```
   - 总记录数：实时累计
   - Discard 动作数：验证失败被丢弃的数量
   - Allowlist 失败数：允许列表验证失败的次数
   ```

3. 等待一条 Discard 记录出现，立即暂停：
   ```
   看这条记录！源地址 192.0.2.123 从接口 eth0 进入，
   但不在允许列表的 3 个前缀中，因此被丢弃。
   
   savMatchedContentList 字段清楚展示了允许的规则：
   - 10.1.1.0/24
   - 10.2.2.0/24  
   - 10.3.3.0/24
   
   这就是"清白证明"——快速定位是 SAV 还是其他原因导致的丢包。
   ```

#### 场景2：跨模式统计分析（40秒）

**讲解要点**：
```
第二个场景展示不同验证模式的效果对比。
```

**操作**：
1. 点击 **Mode Statistics** 标签
2. 继续播放，观察统计数据实时更新
3. 指出饼图和统计卡片：
   ```
   实时统计显示：
   
   - 接口基础验证：X 条记录
   - 前缀基础验证：Y 条记录
   
   - 允许列表规则：X 条
   - 阻止列表规则：Y 条
   
   饼图动态更新，直观展示两种验证模式的分布。
   
   这帮助运维人员了解：哪种验证模式更常用？
   哪种更有效？是否需要调整策略？
   ```

#### 场景3：策略动作跟踪（40秒）

**讲解要点**：
```
第三个场景量化 SAV 策略的执行效果。
```

**操作**：
1. 点击 **Policy Tracking** 标签
2. 指出 4 种策略动作的统计：
   ```
   SAV 支持 4 种策略动作：
   
   - Permit (允许): 验证通过，正常放行
   - Discard (丢弃): 验证失败，直接丢弃
   - Rate-limit (限速): 验证失败，限速处理
   - Redirect (重定向): 重定向到蜜罐或隔离区
   
   柱状图实时更新，量化每种动作的执行次数。
   
   比如看到 Discard 占 84%，说明大部分攻击流量被直接拦截，
   SAV 策略很有效。
   ```

---

### 第四部分：总结与亮点（1分钟）

**讲解要点**：
```
总结一下这个系统的三个核心价值：

1. **标准化**
   完全基于 IETF 标准：RFC 7011 (IPFIX)、RFC 6313 (SubTemplateList)
   和 draft-cao-opsawg-ipfix-sav-01 (SAV 扩展)

2. **实时性**
   通过 IPFIX 流式协议，路由器可以实时推送 SAV 验证事件，
   而不是轮询或批量导出

3. **可操作性**
   不只是监控，更是运维工具：
   - 攻击检测：从趋势发现异常
   - 故障排查：快速定位是否 SAV 导致
   - 策略优化：量化数据支撑决策

这就是为什么我们选择 IPFIX——它是网络遥测的行业标准，
SAV + IPFIX 让源地址验证真正具备了可观测性。
```

**最后操作**：
1. 点击 **Reset** 重置演示
   ```
   系统可以随时重置，循环播放，便于反复演示。
   ```

2. 调整速度到 **4x**，快速播放一遍
   ```
   加速播放展示完整数据流，27 条记录在十几秒内全部推送完成。
   ```

---

## 🎯 演示要点提醒

### 必须强调的点
1. **IPFIX 是标准协议**，不是私有方案
2. **4 个 SAV 扩展字段**都在 draft-cao-opsawg-ipfix-sav-01 中定义
3. **SubTemplateList** (RFC 6313) 是关键技术，解决了复杂结构导出
4. **实时流式**是 IPFIX 的核心优势，区别于传统日志

### 可能的问题应对

**Q: 为什么用 IPFIX 而不是 syslog 或其他日志？**
```
A: IPFIX 是 IETF 专为网络遥测设计的标准协议，具有：
   - 结构化数据（不是纯文本）
   - 实时流式推送（不是批量）
   - 可扩展的信息元素（支持私有扩展）
   - 高性能（二进制编码，适合大流量）
```

**Q: SubTemplateList 是什么？**
```
A: RFC 6313 定义的 IPFIX 扩展，用于导出列表或嵌套结构。
   比如 SAV 规则可能有多个接口-前缀映射，用 SubTemplateList 
   可以在单条 IPFIX 记录中完整导出。
```

**Q: 这个系统可以用于生产环境吗？**
```
A: 当前是演示系统，使用预生成数据。但架构和协议设计都是面向
   生产的：
   - Go 实现的 IPFIX 编解码器可直接用于路由器
   - SSE 可以替换为标准 IPFIX 采集器（如 nfdump）
   - 前端可以连接实时采集器，展示真实数据
```

---

## 📊 演示效果检查清单

演示前确认：
- [ ] 系统启动成功，端口 8888 可访问
- [ ] 浏览器打开正常，无控制台错误
- [ ] 所有 27 条记录都能正常加载
- [ ] 三个分析面板都能正常切换
- [ ] 图表能正常渲染和更新

演示中检查：
- [ ] 记录推送流畅，无卡顿
- [ ] 时间轴同步更新
- [ ] 统计数字实时变化
- [ ] 图表动态更新

---

## 🚀 高级技巧

### 加速完整演示（10秒版）
```
1. 设置速度 4x
2. 点击 Start
3. 10 秒后自动完成全部 27 条记录
4. 直接查看最终统计结果
```

### 慢速详细讲解（2分钟版）
```
1. 设置速度 0.5x
2. 每条记录暂停讲解
3. 重点展开 savMatchedContentList 字段
```

### 循环播放模式
```
播放完成后会自动重置到起点，支持无限循环演示
```

---

**演示时长分配**：
- 开场：30 秒
- 实时流展示：1分30秒
- 三个场景分析：2分钟
- 总结：1分钟
- **总计：5分钟**

**关键成功因素**：
✓ 流畅的演示节奏
✓ 清晰的技术讲解
✓ 突出 IPFIX 标准化和实时性
✓ 强调三个场景的实际运维价值
